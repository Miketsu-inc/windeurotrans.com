---
const { lang = "en" } = Astro.props

const text = {
    en: {
        whyus: "Why us?"
    },
    hu: {

    },
    it: {

    }
}
---
 <nav
      class="text-text_color fixed top-5 right-5 left-5 z-50 flex w-auto
        items-center justify-between rounded-3xl border border-stone-500/10
        bg-stone-500/10 p-5 shadow-md backdrop-blur-xs transition-all
        duration-300 md:right-auto md:left-1/2 md:w-fit md:-translate-x-1/2"
    >
      <div
        class="text-xl font-extrabold tracking-tighter uppercase
          transition-colors md:text-2xl"
      >
        <a href="#">Wind<span class="text-primary">eurotrans</span></a>
      </div>

      <ul
        class="hidden gap-10 text-sm font-medium tracking-widest uppercase
          transition-colors md:flex md:px-24"
      >
        <li>
          <a href="#whyus" class="hover:text-primary transition-colors"
            >Why us?</a
          >
        </li>
        <li>
          <a href="#services" class="hover:text-primary transition-colors"
            >Services</a
          >
        </li>
        <li>
          <a href="#about" class="hover:text-primary transition-colors"
            >About</a
          >
        </li>
        <li>
          <a href="#contact" class="hover:text-primary transition-colors"
            >Contact</a
          >
        </li>
      </ul>

      <div class="relative hidden md:block">
        <button
          id="langButton"
          class="hover:text-primary flex cursor-pointer items-center gap-2
            transition-colors"
          aria-label="Select language"
        >
          <span id="currentFlag" class="text-xl">ðŸ‡­ðŸ‡º</span>
          <svg
            class="h-4 w-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            ></path>
          </svg>
        </button>
        <div
          id="langDropdown"
          class="bg-bg_color absolute right-0 mt-2 hidden w-32 overflow-hidden
            rounded-lg border border-stone-500/10 shadow-md"
        >
          <button
            class="lang-option flex w-full cursor-pointer items-center gap-2
              px-4 py-2 text-left transition-colors hover:bg-gray-100"
            data-lang="hu"
            data-flag="ðŸ‡­ðŸ‡º"
          >
            <span class="text-xl">ðŸ‡­ðŸ‡º</span>
            <span class="text-sm">Magyar</span>
          </button>
          <button
            class="lang-option flex w-full cursor-pointer items-center gap-2
              px-4 py-2 text-left transition-colors hover:bg-gray-100"
            data-lang="en"
            data-flag="ðŸ‡¬ðŸ‡§"
          >
            <span class="text-xl">ðŸ‡¬ðŸ‡§</span>
            <span class="text-sm">English</span>
          </button>
        </div>
      </div>

      <!-- Spacer to push menu button to the right on mobile -->
      <div class="navbar-spacer flex-1 md:hidden"></div>

      <button
        id="mobileMenuBtn"
        class="relative md:hidden"
        aria-label="Toggle menu"
      >
        <!-- Menu Icon (default) -->
        <svg
          id="menuIcon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="size-6 transition-opacity duration-300"
        >
          <path d="M4 5h16" />
          <path d="M4 12h16" />
          <path d="M4 19h16" />
        </svg>
        <!-- X Icon (hidden by default) -->
        <svg
          id="closeIcon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="absolute top-1/2 left-1/2 size-6 -translate-x-1/2
            -translate-y-1/2 opacity-0 transition-opacity duration-300"
        >
          <path d="M18 6 6 18" />
          <path d="m6 6 12 12" />
        </svg>
      </button>
    </nav>

    <div
      id="mobileMenu"
      class="mobile-menu fixed inset-0 z-40 bg-white/50 backdrop-blur-md"
    >
      <div class="flex h-full flex-col items-center justify-center gap-8 px-8">
        <!-- Mobile Navigation Links -->
        <a
          href="#whyus"
          class="mobile-nav-link hover:text-primary text-3xl font-medium
            tracking-wider uppercase transition-colors"
          >Why us?</a
        >
        <a
          href="#services"
          class="mobile-nav-link hover:text-primary text-3xl font-medium
            tracking-wider uppercase transition-colors"
          >Services</a
        >
        <a
          href="#about"
          class="mobile-nav-link hover:text-primary text-3xl font-medium
            tracking-wider uppercase transition-colors"
          >About</a
        >
        <a
          href="#contact"
          class="mobile-nav-link hover:text-primary text-3xl font-medium
            tracking-wider uppercase transition-colors"
          >Contact</a
        >

        <!-- Mobile Language Selector -->
        <div class="mt-8 flex gap-4">
          <button
            class="mobile-lang-option text-4xl transition-transform
              hover:scale-110"
            data-lang="hu"
            data-flag="ðŸ‡­ðŸ‡º"
          >
            ðŸ‡­ðŸ‡º
          </button>
          <button
            class="mobile-lang-option text-4xl transition-transform
              hover:scale-110"
            data-lang="en"
            data-flag="ðŸ‡¬ðŸ‡§"
          >
            ðŸ‡¬ðŸ‡§
          </button>
        </div>
      </div>
    </div>

    <script>
      const mobileMenuBtn = document.getElementById("mobileMenuBtn")!;
      const mobileMenu = document.getElementById("mobileMenu")!;
      const mobileNavLinks = document.querySelectorAll(".mobile-nav-link")!;
      const menuIcon = document.getElementById("menuIcon")!;
      const closeIcon = document.getElementById("closeIcon")!;
      const langButton = document.getElementById("langButton")!;
      const langDropdown = document.getElementById("langDropdown")!;
      const currentFlag = document.getElementById("currentFlag")!;
      const langOptions = document.querySelectorAll<HTMLElement>(".lang-option")!;
      const mobileLangOptions = document.querySelectorAll<HTMLElement>(
        ".mobile-lang-option"
      )!;
      const navbar = document.querySelector("nav")!;

      // Detect browser language and set initial language
      let currentLang = "hu"; // default fallback
      const browserLang = navigator.language;

      // Check if browser language starts with 'en' (en, en-US, en-GB, etc.)
      if (browserLang.startsWith("en")) {
        currentLang = "en";
      } else if (browserLang.startsWith("hu")) {
        currentLang = "hu";
      }

      // Mobile menu toggle
      mobileMenuBtn.addEventListener("click", () => {
        const isOpen = mobileMenu.classList.contains("menu-open");

        if (isOpen) {
          // Close menu
          mobileMenu.classList.remove("menu-open");
          navbar.classList.remove("menu-open");
          document.body.classList.remove("menu-open");
          menuIcon.style.opacity = "1";
          closeIcon.style.opacity = "0";
        } else {
          // Open menu
          mobileMenu.classList.add("menu-open");
          navbar.classList.add("menu-open");
          document.body.classList.add("menu-open");
          menuIcon.style.opacity = "0";
          closeIcon.style.opacity = "1";
        }
      });

      // Close mobile menu when clicking a link
      mobileNavLinks.forEach((link) => {
        link.addEventListener("click", () => {
          mobileMenu.classList.remove("menu-open");
          navbar.classList.remove("menu-open");
          document.body.classList.remove("menu-open");
          menuIcon.style.opacity = "1";
          closeIcon.style.opacity = "0";
        });
      });

      // Desktop language selector
      langButton.addEventListener("click", (e) => {
        e.stopPropagation();
        langDropdown.classList.toggle("hidden");
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", () => {
        langDropdown.classList.add("hidden");
      });

      // Language selection (desktop)
      langOptions.forEach((option) => {
        option.addEventListener("click", (e) => {
          e.stopPropagation();
          currentLang = option.dataset.lang!;
          currentFlag.textContent = option.dataset.flag!;
          langDropdown.classList.add("hidden");
        });
      });

      // Language selection (mobile)
      mobileLangOptions.forEach((option) => {
        option.addEventListener("click", () => {
          currentLang = option.dataset.lang!;
          currentFlag.textContent = option.dataset.flag!;
          // Visual feedback
          mobileLangOptions.forEach((opt) => (opt.style.opacity = "0.5"));
          option.style.opacity = "1";
        });
      });

      // Set initial language display based on detected language
      const initialFlag = currentLang === "en" ? "ðŸ‡¬ðŸ‡§" : "ðŸ‡­ðŸ‡º";
      currentFlag.textContent = initialFlag;

      // Set initial mobile lang state
      mobileLangOptions.forEach((opt) => {
        opt.style.opacity = opt.dataset.lang === currentLang ? "1" : "0.5";
      });
    </script>